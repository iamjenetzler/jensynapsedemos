{
	"name": "Cold Path 00 CREATE WWI TABLES",
	"properties": {
		"content": {
			"query": "\n/************************************ Create Tables (8s) *********************************/\n\n\ncreate schema wwi\nGo\n\n -- 1. Create [FactTransaction] table\n\nCREATE TABLE [wwi].[FactTransaction]\n( \n\t[TransactionKey] [bigint]  NOT NULL,\n\t[DateKey] [date]  NOT NULL,\n\t[CustomerKey] [int]  NULL,\n\t[BillToCustomerKey] [int]  NULL,\n\t[SupplierKey] [int]  NULL,\n\t[TransactionTypeKey] [int]  NOT NULL,\n\t[PaymentMethodKey] [int]  NULL,\n\t[WWICustomerTransaction ID] [int]  NULL,\n\t[WWISupplierTransaction ID] [int]  NULL,\n\t[WWIInvoiceID] [int]  NULL,\n\t[WWIPurchaseOrderID] [int]  NULL,\n\t[SupplierInvoiceNumber] [nvarchar](20)  NULL,\n\t[TotalExcludingTax] [decimal](18,2)  NOT NULL,\n\t[TaxAmount] [decimal](18,2)  NOT NULL,\n\t[TotalIncludingTax] [decimal](18,2)  NOT NULL,\n\t[OutstandingBalance] [decimal](18,2)  NOT NULL,\n\t[IsFinalized] [nvarchar](5)  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [CustomerKey] ),\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n-- 2. [FactStockHolding]\nCREATE TABLE [wwi].[FactStockHolding]\n( \n\t[StockHoldingKey] [bigint]  NOT NULL,\n\t[StockItemKey] [int]  NOT NULL,\n\t[QuantityOnHand] [int]  NOT NULL,\n\t[BinLocation] [nvarchar](20)  NOT NULL,\n\t[LastStocktakeQuantity] [int]  NOT NULL,\n\t[LastCostPrice] [decimal](18,2)  NOT NULL,\n\t[ReorderLevel] [int]  NOT NULL,\n\t[TargetStockLevel] [int]  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [StockItemKey] ),\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n-- 3.  [FactSale]\nCREATE TABLE [wwi].[FactSale]\n( \n\t[SaleKey] [bigint]  NOT NULL,\n\t[CityKey] [int]  NOT NULL,\n\t[CustomerKey] [int]  NOT NULL,\n\t[BillToCustomerKey] [int]  NOT NULL,\n\t[StockItemKey] [int]  NOT NULL,\n\t[InvoiceDateKey] [date]  NOT NULL,\n\t[DeliveryDateKey] [date]  NULL,\n\t[SalespersonKey] [int]  NOT NULL,\n\t[WWIInvoiceID] [int]  NOT NULL,\n\t[Description] [nvarchar](100)  NOT NULL,\n\t[Package] [nvarchar](50)  NOT NULL,\n\t[Quantity] [int]  NOT NULL,\n\t[UnitPrice] [decimal](18,2)  NOT NULL,\n\t[TaxRate] [decimal](18,3)  NOT NULL,\n\t[TotalExcludingTax] [decimal](18,2)  NOT NULL,\n\t[TaxAmount] [decimal](18,2)  NOT NULL,\n\t[Profit] [decimal](18,2)  NOT NULL,\n\t[TotalIncludingTax] [decimal](18,2)  NOT NULL,\n\t[TotalDryItems] [int]  NOT NULL,\n\t[TotalChillerItems] [int]  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [CustomerKey] ),\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n-- 4. [FactPurchase]\n\nCREATE TABLE [wwi].[FactPurchase]\n( \n\t[PurchaseKey] [bigint]  NOT NULL,\n\t[DateKey] [date]  NOT NULL,\n\t[SupplierKey] [int]  NOT NULL,\n\t[StockItemKey] [int]  NOT NULL,\n\t[WWIPurchaseOrderID] [int]  NULL,\n\t[OrderedOuters] [int]  NOT NULL,\n\t[OrderedQuantity] [int]  NOT NULL,\n\t[ReceivedOuters] [int]  NOT NULL,\n\t[Package] [nvarchar](50)  NOT NULL,\n\t[IsOrderFinalized] [nvarchar](5)  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [SupplierKey] ),\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n-- 5. [FactOrder]\nCREATE TABLE [wwi].[FactOrder]\n( \n\t[OrderKey] [bigint]  NOT NULL,\n\t[CityKey] [int]  NOT NULL,\n\t[CustomerKey] [int]  NOT NULL,\n\t[StockItemKey] [int]  NOT NULL,\n\t[OrderDateKey] [date]  NOT NULL,\n\t[PickedDateKey] [date]  NULL,\n\t[SalespersonKey] [int]  NOT NULL,\n\t[PickerKey] [int]  NULL,\n\t[WWIOrderID] [int]  NOT NULL,\n\t[WWIBackorderID] [int]  NULL,\n\t[Description] [nvarchar](100)  NOT NULL,\n\t[Package] [nvarchar](50)  NOT NULL,\n\t[Quantity] [int]  NOT NULL,\n\t[UnitPrice] [decimal](18,2)  NOT NULL,\n\t[TaxRate] [decimal](18,3)  NOT NULL,\n\t[TotalExcludingTax] [decimal](18,2)  NOT NULL,\n\t[TaxAmount] [decimal](18,2)  NOT NULL,\n\t[TotalIncludingTax] [decimal](18,2)  NOT NULL,\n\t[LineageKey] [int]  NULL\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [CustomerKey] ),\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n--6. [FactMovement]\nCREATE TABLE [wwi].[FactMovement]\n( \n\t[MovementKey] [bigint]  NOT NULL,\n\t[DateKey] [date]  NOT NULL,\n\t[StockItemKey] [int]  NOT NULL,\n\t[CustomerKey] [int]  NULL,\n\t[SupplierKey] [int]  NULL,\n\t[TransactionTypeKey] [int]  NOT NULL,\n\t[WWIStockItemTransactionID] [int]  NOT NULL,\n\t[WWIInvoiceID] [int]  NULL,\n\t[WWIPurchaseOrderID] [int]  NULL,\n\t[Quantity] [int]  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = HASH ( [CustomerKey] ),\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n--7. [DimTransactionType]\nCREATE TABLE [wwi].[DimTransactionType]\n( \n\t[TransactionTypeKey] [int]  NOT NULL,\n\t[WWITransactionTypeID] [int]  NOT NULL,\n\t[TransactionType] [nvarchar](50)  NOT NULL,\n\t[ValidFrom] [datetime2](7)  NOT NULL,\n\t[ValidTo] [datetime2](7)  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = REPLICATE,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n--8. DimSupplier\nCREATE TABLE [wwi].[DimSupplier]\n( \n\t[SupplierKey] [int]  NOT NULL,\n\t[WWISupplierID] [int]  NOT NULL,\n\t[Supplier] [nvarchar](100)  NOT NULL,\n\t[Category] [nvarchar](50)  NOT NULL,\n\t[PrimaryContact] [nvarchar](50)  NOT NULL,\n\t[SupplierReference] [nvarchar](20)  NULL,\n\t[PaymentDays] [int]  NOT NULL,\n\t[PostalCode] [nvarchar](10)  NOT NULL,\n\t[ValidFrom] [datetime2](7)  NOT NULL,\n\t[ValidTo] [datetime2](7)  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = REPLICATE,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n--9. [DimStockItem]\n\nCREATE TABLE [wwi].[DimStockItem]\n( \n\t[StockItemKey] [int]  NOT NULL,\n\t[WWIStockItemID] [int]  NOT NULL,\n\t[Stock Item] [nvarchar](100)  NOT NULL,\n\t[Color] [nvarchar](20)  NOT NULL,\n\t[SellingPackage] [nvarchar](50)  NOT NULL,\n\t[Buying Package] [nvarchar](50)  NOT NULL,\n\t[Brand] [nvarchar](50)  NOT NULL,\n\t[Size] [nvarchar](20)  NOT NULL,\n\t[LeadTimeDays] [int]  NOT NULL,\n\t[QuantityPerOuter] [int]  NOT NULL,\n\t[IsChillerStock] [nvarchar](5)  NOT NULL,\n\t[Barcode] [nvarchar](50)  NULL,\n\t[TaxRate] [decimal](18,3)  NOT NULL,\n\t[UnitPrice] [decimal](18,2)  NOT NULL,\n\t[RecommendedRetailPrice] [decimal](18,2)  NULL,\n\t[TypicalWeightPerUnit] [decimal](18,3)  NOT NULL,\n\t[ValidFrom] [datetime2](7)  NOT NULL,\n\t[ValidTo] [datetime2](7)  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = REPLICATE,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n--10. DimPaymentMethod\nCREATE TABLE [wwi].[DimPaymentMethod]\n( \n\t[PaymentMethodKey] [int]  NOT NULL,\n\t[WWIPaymentMethodID] [int]  NOT NULL,\n\t[PaymentMethod] [nvarchar](50)  NOT NULL,\n\t[ValidFrom] [datetime2](7)  NOT NULL,\n\t[ValidTo] [datetime2](7)  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = REPLICATE,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n--11. [DimEmployee]\nCREATE TABLE [wwi].[DimEmployee]\n( \n\t[EmployeeKey] [int]  NOT NULL,\n\t[WWIEmployeeID] [int]  NOT NULL,\n\t[Employee] [nvarchar](50)  NOT NULL,\n\t[PreferredName] [nvarchar](50)  NOT NULL,\n\t[IsSalesperson] [nvarchar](5)  NOT NULL,\n\t[ValidFrom] [datetime2](7)  NOT NULL,\n\t[ValidTo] [datetime2](7)  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = REPLICATE,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n--12. DimDate\nCREATE TABLE [wwi].[DimDate]\n( \n\t[Date] [date]  NOT NULL,\n\t[DayNumber] [int]  NOT NULL,\n\t[Day] [nvarchar](10)  NOT NULL,\n\t[Month] [nvarchar](10)  NOT NULL,\n\t[ShortMonth] [nvarchar](3)  NOT NULL,\n\t[CalendarMonthNumber] [int]  NOT NULL,\n\t[CalendarMonthLabel] [nvarchar](20)  NOT NULL,\n\t[CalendarYear] [int]  NOT NULL,\n\t[CalendarYearLabel] [nvarchar](10)  NOT NULL,\n\t[FiscalMonthNumber] [int]  NOT NULL,\n\t[FiscalMonthLabel] [nvarchar](20)  NOT NULL,\n\t[FiscalYear] [int]  NOT NULL,\n\t[FiscalYearLabel] [nvarchar](10)  NOT NULL,\n\t[ISOWeekNumber] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = REPLICATE,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n--13. [DimCity]\nCREATE TABLE [wwi].[DimCity]\n( \n\t[CityKey] [int]  NOT NULL,\n\t[WWICityID] [int]  NOT NULL,\n\t[City] [nvarchar](50)  NOT NULL,\n\t[StateProvince] [nvarchar](50)  NOT NULL,\n\t[Country] [nvarchar](60)  NOT NULL,\n\t[Continent] [nvarchar](30)  NOT NULL,\n\t[SalesTerritory] [nvarchar](50)  NOT NULL,\n\t[Region] [nvarchar](30)  NOT NULL,\n\t[Subregion] [nvarchar](30)  NOT NULL,\n\t[LatestRecordedPopulation] [bigint]  NOT NULL,\n\t[ValidFrom] [datetime2](7)  NOT NULL,\n\t[ValidTo] [datetime2](7)  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = REPLICATE,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n--14. [DimCustomer]\nCREATE TABLE [wwi].[DimCustomer]\n( \n\t[CustomerKey] [int]  NOT NULL,\n\t[WWICustomerID] [int]  NOT NULL,\n\t[Customer] [nvarchar](100)  NOT NULL,\n\t[BillToCustomer] [nvarchar](100)  NOT NULL,\n\t[Category] [nvarchar](50)  NOT NULL,\n\t[BuyingGroup] [nvarchar](50)  NOT NULL,\n\t[PrimaryContact] [nvarchar](50)  NOT NULL,\n\t[PostalCode] [nvarchar](10)  NOT NULL,\n\t[ValidFrom] [datetime2](7)  NOT NULL,\n\t[ValidTo] [datetime2](7)  NOT NULL,\n\t[LineageKey] [int]  NOT NULL\n)\nWITH\n(\n\tDISTRIBUTION = REPLICATE,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n--15. [PostalCodes]\nCREATE TABLE [wwi].[PostalCodes]\n( \n\t[City] [nvarchar](30)  NULL,\n\t[State] [nvarchar](30)  NULL,\n\t[Zip] [nvarchar](10)  NULL,\n\t[Latitude] [nvarchar](30)  NULL,\n\t[Longitude] [nvarchar](30)  NULL,\n\t[Timezone] [nvarchar](5)  NULL\n)\nWITH\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\n --16. Employee PII Data\n CREATE TABLE [wwi].[EmployeePIIData]\n( \n\t[Id] [int]  NULL,\n\t[FirstName] [nvarchar](30)  NULL,\n\t[LastName] [nvarchar](30)  NULL,\n\t[Company] [nvarchar](30)  NULL,\n\t[Address] [nvarchar](30)  NULL,\n\t[City] [nvarchar](30)  NULL,\n\t[County] [nvarchar](30)  NULL,\n\t[State] [nvarchar](10)  NULL,\n\t[Phone] [varchar](100)  NULL,\n\t[email] [varchar](100)  NULL,\n\t[SSN] [nvarchar](30)  NULL\n)\nWITH\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"name": "sqlpool1",
				"type": "SqlPool"
			}
		},
		"type": "SqlQuery"
	}
}